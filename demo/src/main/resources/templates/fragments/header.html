<!DOCTYPE html>
<html lang="en"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security"
>

<nav class="sb-topnav navbar navbar-expand bg-light" th:fragment="header">
    <!--    <div class="container-fluid">-->
    <!--        <a class="navbar-brand d-flex align-items-center" th:href="@{/}">-->
    <!--            <svg width="32" height="32" viewBox="0 0 32 32" class="me-2">-->
    <!--                <rect x="4" y="6" width="24" height="18" rx="4" fill="#4A90E2"/>-->
    <!--                <path d="M 10 24 L 8 28 L 12 24 Z" fill="#4A90E2"/>-->
    <!--                <circle cx="12" cy="15" r="2" fill="white"/>-->
    <!--                <circle cx="20" cy="15" r="2" fill="white"/>-->
    <!--                <path d="M 12 18 Q 16 20 20 18" stroke="white" stroke-width="1.5" fill="none"/>-->
    <!--            </svg>-->
    <!--            <span>PULSE</span>-->
    <!--        </a>-->
    <!--    </div>-->

    <!--    <div class="container-fluid">-->
    <!--        <a class="navbar-brand d-flex align-items-center" th:href="@{/}">-->
    <!--            <img src="/images/nexus-icon.png" alt="NEXUS 로고" class="nexus-logo-img me-2">-->
    <!--            <span class="nexus-brand-text">NEXUS</span>-->
    <!--        </a>-->
    <!--    </div>-->

    <!--<div class="container-fluid">-->
    <!--    <a class="navbar-brand d-flex align-items-center" th:href="@{/}">-->
    <!--        <svg class="mx-2" width="35" height="35" viewBox="0 0 100 100" fill="none" xmlns="http://www.w3.org/2000/svg">-->
    <!--            <defs>-->
    <!--                <linearGradient id="nexus_orb_grad" x1="0%" y1="0%" x2="100%" y2="100%">-->
    <!--                    <stop offset="0%" stop-color="#4DA9FF" />-->
    <!--                    <stop offset="100%" stop-color="#9D56FF" />-->
    <!--                </linearGradient>-->

    <!--                <filter id="glow" x="-20%" y="-20%" width="140%" height="140%">-->
    <!--                    <feGaussianBlur stdDeviation="2" result="blur" />-->
    <!--                    <feComposite in="SourceGraphic" in2="blur" operator="over" />-->
    <!--                </filter>-->
    <!--            </defs>-->

    <!--            <g filter="url(#glow)">-->
    <!--                <ellipse cx="50" cy="50" rx="20" ry="45" stroke="url(#nexus_orb_grad)" stroke-width="2.5" transform="rotate(0, 50, 50)" />-->
    <!--                <ellipse cx="50" cy="50" rx="20" ry="45" stroke="url(#nexus_orb_grad)" stroke-width="2.5" transform="rotate(60, 50, 50)" />-->
    <!--                <ellipse cx="50" cy="50" rx="20" ry="45" stroke="url(#nexus_orb_grad)" stroke-width="2.5" transform="rotate(-60, 50, 50)" />-->

    <!--                <circle cx="50" cy="50" r="8" fill="url(#nexus_orb_grad)" />-->
    <!--                <circle cx="50" cy="50" r="4" fill="white" fill-opacity="0.8" />-->
    <!--            </g>-->
    <!--        </svg>-->
    <!--        <span class="nexus-brand-text">NEXUS</span>-->
    <!--    </a>-->

    <div class="header-left">

        <a class="navbar-brand d-flex align-items-center me-0" th:href="@{/}">
            <svg width="35" height="35" viewBox="0 0 100 100" fill="none" xmlns="http://www.w3.org/2000/svg">
                <defs>
                    <linearGradient id="nexus_orb_grad" x1="0%" y1="0%" x2="100%" y2="100%">
                        <stop offset="0%" stop-color="#4DA9FF"/>
                        <stop offset="100%" stop-color="#9D56FF"/>
                    </linearGradient>
                    <filter id="glow" x="-20%" y="-20%" width="140%" height="140%">
                        <feGaussianBlur stdDeviation="2" result="blur"/>
                        <feComposite in="SourceGraphic" in2="blur" operator="over"/>
                    </filter>
                </defs>
                <g filter="url(#glow)">
                    <ellipse cx="50" cy="50" rx="20" ry="45" stroke="url(#nexus_orb_grad)" stroke-width="2.5"
                             transform="rotate(0, 50, 50)"/>
                    <ellipse cx="50" cy="50" rx="20" ry="45" stroke="url(#nexus_orb_grad)" stroke-width="2.5"
                             transform="rotate(60, 50, 50)"/>
                    <ellipse cx="50" cy="50" rx="20" ry="45" stroke="url(#nexus_orb_grad)" stroke-width="2.5"
                             transform="rotate(-60, 50, 50)"/>
                    <circle cx="50" cy="50" r="8" fill="url(#nexus_orb_grad)"/>
                    <circle cx="50" cy="50" r="4" fill="white" fill-opacity="0.8"/>
                </g>
            </svg>
            <span class="nexus-brand-text ms-2 d-none d-sm-inline">Nexus</span>
        </a>
        <button class="btn btn-link btn-sm order-1 order-lg-0 me-4 me-lg-0" id="sidebarToggle" href="#!">
            <i class="fas fa-bars"></i>
        </button>
    </div>




    <button class="navbar-toggler" type="button" data-bs-toggle="collapse"
            data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent"
            aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
    </button>

    <!--        <div class="collapse navbar-collapse" id="navbarSupportedContent">-->

    <!--            <form class="d-flex mx-auto" role="search" style="max-width: 400px; width: 100%;">-->
    <!--                <div class="input-group custom-search-group">-->
    <!--                    <button class="btn btn-outline-primary" type="submit">-->
    <!--                        <i class="fas fa-search"></i>-->
    <!--                    </button>-->
    <!--                    <input class="form-control" type="search" placeholder="Search" aria-label="Search"/>-->
    <!--                </div>-->
    <!--            </form>-->

    <div class="header-center">
        <form class="d-flex" role="search" style="width: 100%; max-width: 450px;">
            <div class="input-group custom-search-group">
                <button class="btn btn-outline-primary" type="submit">
                    <i class="fas fa-search"></i>
                </button>
                <input class="form-control" type="search" placeholder="Search in Nexus..." aria-label="Search"/>
            </div>
        </form>
    </div>


    <div class="header-right">
        <ul class="navbar-nav ms-auto mb-2 mb-lg-0 align-items-center">
            <li class="nav-item" sec:authorize="isAnonymous()">
                <a class="nav-link" th:href="@{/user/login}">
                    <button type="button" class="btn btn-sm btn-primary">Login</button>
                </a>
            </li>
            <li class="nav-item" sec:authorize="isAnonymous()">
                <a class="nav-link" th:href="@{/user/join}">
                    <button type="button" class="btn btn-sm btn-primary">SignUp</button>
                </a>
            </li>

            <li class="nav-item" sec:authorize="isAuthenticated()">
                <a class="nav-link px-2 text-black" th:href="@{/}">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                         class="bi bi-chat-dots" viewBox="0 0 16 16">
                        <path d="M5 8a1 1 0 1 1-2 0 1 1 0 0 1 2 0m4 0a1 1 0 1 1-2 0 1 1 0 0 1 2 0m3 1a1 1 0 1 0 0-2 1 1 0 0 0 0 2"/>
                        <path d="m2.165 15.803.02-.004c1.83-.363 2.948-.842 3.468-1.105A9 9 0 0 0 8 15c4.418 0 8-3.134 8-7s-3.582-7-8-7-8 3.134-8 7c0 1.76.743 3.37 1.97 4.6a10.4 10.4 0 0 1-.524 2.318l-.003.011a11 11 0 0 1-.244.637c-.079.186.074.394.273.362a22 22 0 0 0 .693-.125m.8-3.108a1 1 0 0 0-.287-.801C1.618 10.83 1 9.468 1 8c0-3.192 3.004-6 7-6s7 2.808 7 6-3.004 6-7 6a8 8 0 0 1-2.088-.272 1 1 0 0 0-.711.074c-.387.196-1.24.57-2.634.893a11 11 0 0 0 .398-2"/>
                    </svg>
                </a>
            </li>
            <li class="nav-item" sec:authorize="isAuthenticated()">
                <a class="nav-link px-2 text-black" th:href="@{/board/register}" title="글쓰기">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                         class="bi bi-plus-square" viewBox="0 0 16 16">
                        <path d="M14 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2z"/>
                        <path d="M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4"/>
                    </svg>
                    만들기
                    <i class="bi bi-file-plus fs-5"></i>
                </a>
            </li>
            <li class="nav-item dropdown" sec:authorize="isAuthenticated()">

                <a class="nav-link dropdown-toggle text-black" id="navbarDropdown" href="#" role="button"
                   data-bs-toggle="dropdown">
                    <span th:text="${#authentication.principal.user.nickName}">사용자</span>
                </a>
                <ul class="dropdown-menu dropdown-menu-end">
                    <li><a class="dropdown-item" th:href="@{/user/modify}">Profile</a></li>
                    <li sec:authorize="hasAnyAuthority('ROLE_ADMIN')"><a class="dropdown-item"
                                                                         th:href="@{/user/list}">User List</a></li>
                    <li>
                        <hr class="dropdown-divider"/>
                    </li>
                    <li><a class="dropdown-item" id="logout" href="">Logout</a>
                        <form action="/user/logout" method="post" id="logoutForm"></form>
                    </li>
                </ul>
            </li>
        </ul>
    </div>
    </div>
    </div>
    <script>
        document.getElementById("logout").addEventListener('click', (e) => {
            e.preventDefault();
            document.getElementById('logoutForm').submit();
        });

        window.addEventListener('DOMContentLoaded', event => {
            // 1. 클릭 이벤트 발생 시 전체 문서에서 #sidebarToggle을 찾음 (이벤트 위임)
            document.addEventListener('click', function (e) {
                const toggleBtn = e.target.closest('#sidebarToggle');

                if (toggleBtn) {
                    e.preventDefault();
                    // body에 클래스 토글
                    document.body.classList.toggle('sb-sidenav-toggled');

                    // 상태 저장 (로그인 유지 시에도 사이드바 상태 기억)
                    localStorage.setItem('sb|sidebar-toggle', document.body.classList.contains('sb-sidenav-toggled'));
                }
            });

            // 2. 초기 로드 시 로컬스토리지 값 적용
            if (localStorage.getItem('sb|sidebar-toggle') === 'true') {
                document.body.classList.add('sb-sidenav-toggled');
            }
        });
    </script>
</nav>

